<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.742409eb857ab2ccca34.css" data-identity="gatsby-global-css">li{margin-right:1rem}h1,li{display:inline-block}h1{font-style:normal;margin-top:0}header{margin-bottom:1.5rem}header ul{float:right;list-style:none}#wrapper{margin:3em auto;max-width:700px;padding:10px}.blogPostDate{color:#333;font-size:8pt;margin-bottom:9px;padding-top:4px}</style><meta name="generator" content="Gatsby 4.4.0"/><title data-react-helmet="true">m0n0deb</title><link data-react-helmet="true" rel="canonical" href="https://www.docunext.com/2007/07/m0n0deb/"/><link as="script" rel="preload" href="/webpack-runtime-910253975eed29c257e8.js"/><link as="script" rel="preload" href="/framework-e27ef662c918f795a5a3.js"/><link as="script" rel="preload" href="/app-578f356f1ad3d3b2b65e.js"/><link as="script" rel="preload" href="/commons-bbb2797d08d51fd1bd26.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js"/><link as="fetch" rel="preload" href="/page-data/2007/07/m0n0deb/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2191495970.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4224293195.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="wrapper"><header><ul><li><a href="/about/">About</a></li></ul><a href="/"><h1>Docunext</h1></a></header><hr/><div><h2>m0n0deb</h2><div class="blogPostDate">July 23rd, 2007</div><div><p>I'm exploring the idea of "reducing" a debian bootstrap chroot, similarly to how the m0n0wall build scripts copy only the necessary files for a running system from a FreeBSD jail.</p>
<p>The base debian bootstrap uses about 166MB (after apt-get clean and localepurge, it is only 120MB), which is pretty small as it is. Most of the stuff isn't needed though. I would like  the build to not actually have an sshd server, and similar console messages to m0n0wall.</p>
<p>I think the process would even be simpler than the m0n0wall building process, because of how everything is installed.</p>
<pre>host+-- chroot  +-- target to do a minidebootstrap to</pre>
<p>Several questions remain:</p>
<ul><li>Which filesystem? JFFS2? Squashfs? YAFFS? CRAMFS?</li><li>How does the init process for debian differ from that for FreeBSD?</li><li>How would the initramfs involved in the process?</li><li>How could the image be used on different types of media, like CDs, USB Flash drives, CF, IDE, or SATA drives?</li><li>What about partitions?</li></ul>
<p>I think I'll just try a few different experiments to see what happens. How? QEMU!</p>
<p>How does m0n0wall build such a mini distro: <ol><li>the m0n0wall.files file contains a list of all the files which can be copied over to the target image</li><li>builds a customer kernel which only contains the required modules</li><li>The libs required by the target userland are identified by ldd in mklibs.pl?</li><li>loader.cf turns dma off for compatibility with a variety of cf cards</li></ol></p>
<p>I learn better by doing than reading, so I'll probably do some trial and error experiments with QEMU and see what happens. I just remembered that I had seen an article about running debian on a 32mb compact flash drive at one point, here it is: <a href="http://www.linuxdevices.com/articles/AT4540125636.html">Embedding Debian GNU/Linux in a 32MB CompactFlash</a> by by Bao C. Ha.</p>
<p>This has a lot of very helpful information. I just scanned through it again, and I'm sure I'll be reading it again and again in the coming days!</p>
<p>On the FreeBSD side of things, there is the excellent <a href="https://neon1.net/misc/minibsd.html">miniBSD - reducing FreeBSD</a> by Manuel Kasper. This also has a lot of great stuff. There is a lot of cool parallels between the two guides and I think a phing-based build process will work really well for both operating systems.</p>
<p>On the "WRT" side of things, OpenWRT uses ipkg, from handhelds.org. An "itsy" package management system. Along those lines is the <a href="http://wiki.openwrt.org/SoekrisPort">Soekris Port of the OpenWRT distribution</a>. I just found an interview with the founder of FreeWRT discussing the differences between it and OpenWRT, the site was down, so I mirrored the interview from Google's cache <a href="http://www.docunext.com/">here</a>. At the same time, I checked out kamikaze from OpenWRT and it seems to be working well - I'm compiling an x86 image with all the packages right now, among them ipkg and uClibc. Cool!</p>
<p>Argh, unfortunately that build failed too. Now I'm going to try building uClinux. Actually no I'm not. After reading some more about uClinux, FreeWRT, and OpenWRT, I think my focus remains on standard hardware. While I really like the idea of uClinux, the lure of debian is too strong! And for good reason. Debian is awesome.</p>
<p>The plan then is to stick with FreeBSD and debian as the basis for building mini-distros. And with my recent foray into <a href="http://www.docunext.com/2007/07/trying-openvz/">OpenVZ</a>, it should be easier to test various "reduced" debian systems. While I'm at it, I'll try to clarify the goal here:</p>
<ul><li>Not the smallest system possible, but retain the amazing debian core, and provide a "webmin-like" administration webgui that is flexible and extensible</li><li>This would essentially remove the need for an X11 server, yet provide user-friendly administrative powers to average users</li><li>Furthermore, this could be achieved with low-power, low-cost hardware</li></ul>
<p>My guess is that both Debian and FreeBSD (among others) will work very well for this purpose, and making the build process support them both (at least) will open the sphere of influence to a great audience.</p>
<p>UPDATE: A new psuedo-distro is in the works: <a href="http://www.nodows.com/">NODOWS</a>.</p></div></div><div><span>Yearly Indexes: </span><span><a href="/2003/"><span>2003</span></a> </span><span><a href="/2004/"><span>2004</span></a> </span><span><a href="/2006/"><span>2006</span></a> </span><span><a href="/2007/"><span>2007</span></a> </span><span><a href="/2008/"><span>2008</span></a> </span><span><a href="/2009/"><span>2009</span></a> </span><span><a href="/2010/"><span>2010</span></a> </span><span><a href="/2011/"><span>2011</span></a> </span><span><a href="/2012/"><span>2012</span></a> </span><span><a href="/2013/"><span>2013</span></a> </span><span><a href="/2015/"><span>2015</span></a> </span><span><a href="/2019/"><span>2019</span></a> </span><span><a href="/2020/"><span>2020</span></a> </span><span><a href="/2022/"><span>2022</span></a> </span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2007/07/m0n0deb/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9068a959998310636008.js"],"app":["/app-578f356f1ad3d3b2b65e.js"],"component---src-pages-about-js":["/component---src-pages-about-js-738961a9611f9aa4e8d4.js"],"component---src-pages-games-react-nuzaq-js":["/component---src-pages-games-react-nuzaq-js-50d5da494a82a1aaeb8b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-3aa2421409c5653df938.js"],"component---src-pages-years-js":["/component---src-pages-years-js-d36f319c6c16ef9e8314.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js"],"component---src-templates-year-js":["/component---src-templates-year-js-e8af3ddab603f61c6142.js"]};/*]]>*/</script><script src="/polyfill-9068a959998310636008.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js" async=""></script><script src="/commons-bbb2797d08d51fd1bd26.js" async=""></script><script src="/app-578f356f1ad3d3b2b65e.js" async=""></script><script src="/framework-e27ef662c918f795a5a3.js" async=""></script><script src="/webpack-runtime-910253975eed29c257e8.js" async=""></script></body></html>