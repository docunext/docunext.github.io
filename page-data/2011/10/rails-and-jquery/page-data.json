{"componentChunkName":"component---src-templates-blog-post-js","path":"/2011/10/rails-and-jquery/","result":{"data":{"site":{"siteMetadata":{"domain":"https://www.docunext.com"}},"markdownRemark":{"html":"<p>I'm finally digging into the jQuery setup with Rails 3.1. As you are all likely aware, jQuery is the new default javascript language in Rails 3.1. This is great, in my opinion. I really like jQuery - so much that I leaned away from Rails 2.x for awhile because of its tight integration with Prototype.</p>\n<p>jQuery and Rails are paired by default, but I am also digging into jquery-ujs - an ubobtrusive scripting adapter for jQuery.</p>\n<p>Specifically, this means:</p>\n<ul>\n<li>The ability to use \":remote => true\" with Rails form_for and link_to helpers.</li>\n<li>AJAX updates!</li>\n<li>The prevention of double form submits.</li>\n<li>The ability to make POST, PUT, and DELETE requests from hyperlinks.</li>\n</ul>\n<p>Sweet! Especially with regard to AJAX updates, and that's what I've been working with recently.</p>\n<h2>jQuery and Rails 3 AJAX Form Submission and Flash Update</h2>\n<p>Here's an example of an AJAX form submission and a response to update the page flash. It requires several components:</p>\n<ul>\n<li>The form view</li>\n<li>The controller action</li>\n<li>The javascript response</li>\n</ul>\n<h4>The AJAX Form Submission: \":remote => true\"</h4>\n<p>All that's required for a form to use AJAX is the :remote argument set to true. Here's an example of a Rails 3 form that is set to submit via AJAX:</p>\n<pre class=\"terminal\">\n    = form_for(Comment.new, :remote => true) do |f|\n      = f.hidden_field :commentable_id, :value => resource.id\n      = f.hidden_field :commentable_type, :value => resource.class\n      = f.label :comment\n      %br/\n      = f.text_area :comment, :rows => 2\n      %br/\n      = f.submit \"Post Comment\"\n</pre>\n<h4>Using The Rails 3 Controller \"respond_to\" Method</h4>\n<p>First I placed this line at the top of my CommentsController:</p>\n<pre class=\"sh_ruby\">\nrespond_to :js, :html\n</pre>\n<p>Then the create action:</p>\n<pre class=\"sh_ruby\">\n  def create\n    params[:comment][:user_id] = current_user || -1\n    @comment = Comment.new(params[:comment])\n    flash[:notice] = \"Comment created. It will need to be approved by a moderator.\" if @comment.save\n    respond_with( @comment, :layout => !request.xhr? )\n  end\n</pre>\n<h4>The ERB Powered Javascript Response</h4>\n<p>Now comes the jQuery part! I created a create.js.erb file, like this:</p>\n<pre class=\"sh_html\">\n&lt;% if @comment.errors.any? %&gt;\n&lt;% else %&gt;\n  $(\"#flash_messages\").append('&lt;%= escape_javascript(render(:partial =&gt; 'flash', :locals =&gt; {:flash =&gt; flash, :flush_flash =&gt; true})) %&gt;');\n&lt;% end %&gt;\n</pre>","fields":{"slug":"/2011/10/rails-and-jquery/"},"frontmatter":{"title":"Rails 3 and jQuery by Example","date":"October 15th, 2011","tags":"jquery,rails3"}}},"pageContext":{"slug":"/2011/10/rails-and-jquery/"}}}