{"componentChunkName":"component---src-templates-blog-post-js","path":"/2011/01/rake-recipe-for-vlad-to-generate-daemontools-service/","result":{"data":{"markdownRemark":{"html":"<p>When writing <a href=\"/wiki/Ruby\">Ruby</a> web applications, I use Rake to help automate repetative tasks, <a href=\"/wiki/Vlad\">Vlad</a> for deployment, and <a href=\"/wiki/daemontools\">daemontools</a> to actually run the web-service.</p>\n<p>To help with the process of launching Ruby web applications that are spawned and managed by daemontools, I wrote up this <strong>Vlad-based Rake</strong> task which generates a daemontools service with only a few keystrokes:</p>\n<pre class=\"sh_ruby\">\n  remote_task :mkdaemon do\n    run \"mkdir -p /tmp/#{@application}/log\"\n    run \"echo '#!/bin/sh' &gt; /tmp/#{@application}/run\"\n    run \"echo 'exec /var/www/dev/#{@application}/current/demo.sh' &gt;&gt; /tmp/#{@application}/run\"\n    run \"echo '#!/bin/sh' &gt; /tmp/#{@application}/log/run\"\n    run \"echo 'exec setuidgid daemon multilog t ./main' &gt;&gt; /tmp/#{@application}/log/run\"\n    run \"sudo chown -R root:root /tmp/#{@application}\"\n    run \"sudo chmod +x /tmp/#{@application}/run\"\n    run \"sudo chmod +x /tmp/#{@application}/log/run\"\n    run \"sudo mv /tmp/#{@application} /service/\"\n  end\n</pre>\n<p>That snippet is just the Vlad task, not the full vlad recipe. To be a complete vlad task, it is placed inside of a rake <em>namespace</em>:</p>\n<pre class=\"sh_ruby\">\nnamespace :vlad do\n# ...\nend\n</pre>\n<p>Then I simply issue this command:</p>\n<pre class=\"sh_sh\">\nrake vlad:mkdaemon\n</pre>\n<p>I am considering packaging this and other vlad recipes into a gem. Anyone interested?</p>","frontmatter":{"title":"Rake Recipe for Vlad to Generate Daemontools Service","date":"January 11th, 2011"}}},"pageContext":{"slug":"/2011/01/rake-recipe-for-vlad-to-generate-daemontools-service/"}}}