{"componentChunkName":"component---src-templates-blog-post-js","path":"/2009/04/javascript-relative-date/","result":{"data":{"site":{"siteMetadata":{"domain":"https://www.docunext.com"}},"markdownRemark":{"html":"<p>This code is a reduced version of something Joey Hess from Debian wrote for ikiwiki and released to the public domain:</p>\n<pre>// Courtesy of Joey\n// Public Domain Code\n// http://joey.kitenet.net/blog/entry/relative_dates_in_html/\n\nvar timeUnits = new Array;\ntimeUnits['minute'] = 60;\ntimeUnits['hour'] = timeUnits['minute'] * 60;\ntimeUnits['day'] = timeUnits['hour'] * 24;\ntimeUnits['month'] = timeUnits['day'] * 30;\ntimeUnits['year'] = timeUnits['day'] * 364;\nvar timeUnitOrder = ['year', 'month', 'day', 'hour', 'minute'];\n\nfunction relativeDate(date) {\n    var now = new Date();\n    var offset = date.getTime() - now.getTime();\n    var seconds = Math.round(Math.abs(offset) / 1000);\n\n    var ret = \"\";\n    var shown = 0;\n    for (i = 0; i &lt; timeUnitOrder.length; i++) {\n        var unit = timeUnitOrder[i];\n        if (seconds &gt;= timeUnits[unit]) {\n            var num = Math.floor(seconds / timeUnits[unit]);\n            seconds -= num * timeUnits[unit];\n            if (ret)\n                ret += \"and \";\n            ret += num + \" \" + unit + (num &gt; 1 ? \"s\" : \"\") + \" \";\n\n            if (++shown == 2)\n                break;\n        }\n        else if (shown)\n            break;\n    }\n\n    if (! ret)\n        ret = \"less than a minute \"\n\n    return ret + (offset &lt; 0 ? \"ago\" : \"from now\");\n}\n</pre>\n<p>I reduced it so that I could use jQuery selectors and manipulation techniques. Here's how I use it with the open source PhunkyBB forums software project:</p>\n<pre>      $(document).ready(function() {\n        var mytime = \"\";\n        var rltime = \"\";\n        $(\".reldate\").each(function () {\n          mytime = new Date($(this).text() + \"(UTC)\");\n          rltime = relativeDate(mytime);\n          $(this).attr(\"title\",mytime);\n          $(this).text(rltime);\n        });\n      });\n</pre>","fields":{"slug":"/2009/04/javascript-relative-date/"},"frontmatter":{"title":"Javascript Relative Date","date":"April 24th, 2009","tags":null}}},"pageContext":{"slug":"/2009/04/javascript-relative-date/"}}}