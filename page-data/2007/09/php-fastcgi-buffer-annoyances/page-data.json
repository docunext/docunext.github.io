{"componentChunkName":"component---src-templates-blog-post-js","path":"/2007/09/php-fastcgi-buffer-annoyances/","result":{"data":{"site":{"siteMetadata":{"domain":"https://www.docunext.com"}},"markdownRemark":{"html":"<p>I'm trying to produce a continuous client - server connection with PHP and FastCGI or FCGI. Its not working. I found a few items related to the subject I'll share here.</p>\n<p>mod_fcgid has an OutputBuffer setting:</p>\n<pre>\nOutputBufferSize n (64k bytes)\n\nCGI output cache buffer size.</pre>\n<p>mod_fastcgi can be configured with the flush option, but it won't work for dynamic applications:</p>\n<blockquote>\n<p>FastCGI application output is buffered by default. This is not the case for CGI scripts (under Apache 1.3). To override the default behavior, use the -flush option (not available for dynamic applications). Non-parsed header (nph-) scripts will be rejected by mod_fastcgi simply as warning the behavior is different (create a symbolic link to the script without the \"nph-\" prefix if this poses a problem).</blockquote></p>\n<p>Perhaps the \"dynamic\" factor is what prevented me from getting fcgid to work.</p>\n<p>I was able to enable output buffering using libapache2-mod-fastcgi and the -flush setting. Here's my mod_fastcgi:</p>\n<pre><IfModule mod_fastcgi.c>  AddHandler fastcgi-script .fcgi .php  FastCGIConfig -flush  FastCgiIpcDir /var/lib/apache2/fastcgi</IfModule></pre>\n<p>I also found an old note about <a href=\"http://bugs.php.net/bug.php?id=34429\">PHP always buffering in FastCGI mode:</p>\n<p>http://bugs.php.net/bug.php?id=34429</a>, but that appears to have been fixed a long time ago.</p>\n<p>Darn. In my experience, trac.fcgi is way faster when run with mod<em>fcgid than mod</em>fastcgi. Oh well. At least there are options. And for whatever reason, I can't get OutputBufferSize to work at all.</p>\n<p>Incredible! I searched and searched and searched... and finally found. Thanks to PAGE 4 of a search, <a href=\"http://www.mail-archive.com/internals@lists.php.net/msg19643.html\">this thread revealed that the problem was caused by mod_deflate buffering the output</a>!  I disabled the deflate module and the reduced and staggered output buffering worked fine. However, this even happened when I used compression in php.</p>\n<p>Related cool stuff I found while figuring this out:</p>\n<p><a href=\"http://www.seaoffire.net/fcgi-faq.html\">http://www.seaoffire.net/fcgi-faq.html</a></p>\n<p><a href=\"http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html\">http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html</a></p>\n<p><a href=\"http://code.roadsend.com/pcc\">http://code.roadsend.com/pcc</a></p>\n<p><a href=\"http://trac.lighttpd.net/trac/wiki/Docs:ModFastCGI\">http://trac.lighttpd.net/trac/wiki/Docs:ModFastCGI</a></p>\n<p><a href=\"http://www.stanford.edu/services/webauth/\">http://www.stanford.edu/services/webauth/</a></p>\n<p><a href=\"http://shibboleth.internet2.edu/\">http://shibboleth.internet2.edu/</a></p>","fields":{"slug":"/2007/09/php-fastcgi-buffer-annoyances/"},"frontmatter":{"title":"PHP FastCGI fcgid gzip deflate Buffer Annoyances","date":"September 24th, 2007","tags":"fastcgi"}}},"pageContext":{"slug":"/2007/09/php-fastcgi-buffer-annoyances/"}},"staticQueryHashes":["3159585216","758480095"]}