<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.742409eb857ab2ccca34.css" data-identity="gatsby-global-css">li{margin-right:1rem}h1,li{display:inline-block}h1{font-style:normal;margin-top:0}header{margin-bottom:1.5rem}header ul{float:right;list-style:none}#wrapper{margin:3em auto;max-width:700px;padding:10px}.blogPostDate{color:#333;font-size:8pt;margin-bottom:9px;padding-top:4px}</style><meta name="generator" content="Gatsby 4.4.0"/><title data-react-helmet="true">C is for Kool and some Apache stuff</title><link data-react-helmet="true" rel="canonical" href="https://www.docunext.com/2008/06/c-is-for-kool-and-some-apache-stuff/"/><link as="script" rel="preload" href="/webpack-runtime-910253975eed29c257e8.js"/><link as="script" rel="preload" href="/framework-e27ef662c918f795a5a3.js"/><link as="script" rel="preload" href="/app-578f356f1ad3d3b2b65e.js"/><link as="script" rel="preload" href="/commons-bbb2797d08d51fd1bd26.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js"/><link as="fetch" rel="preload" href="/page-data/2008/06/c-is-for-kool-and-some-apache-stuff/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2191495970.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4224293195.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="wrapper"><header><ul><li><a href="/about/">About</a></li></ul><a href="/"><h1>Docunext</h1></a></header><hr/><div><h2>C is for Kool and some Apache stuff</h2><div class="blogPostDate">June 12th, 2008</div><div><p>I had so much fun working with C yesterday, I'm already planning more tasks!</p>
<h4><strong>MySQL and modrewrite</strong></h4>
<p>The mysql client I wrote for use with modrewrite is a great but not at all new concept, and its barely worth testing even, because its so limited. However, given the length of time a proper modrewrite / SQL connector would take for me to finish, it does make sense to test and use a limited connector. Before I test it out for real, I want to switch to using prepared statements.</p>
<p>Apache's 2.3 codebase contains a modrewrite version which includes SQL capabilities, powered by mod_dbd, so it doesn't make too much sense to try and beat that. The fine folks behind Apache are way more skilled than I, but I might be able to help analyze the use case scenarios.</p>
<h4><strong>re2c and modrewrite</strong></h4>
<p>Besides SQL, there are other types of logic which can be used with modrewrite. The module itself supports regular expressions already, and its pretty efficient as far as I know, but the rule sets can easily become overbearing. When the are consolidated and "minified", they become cryptic and vague.</p>
<p>Spamassassin and php using re2c (regular expressions to c) to generate efficient C code scanners. I spent a few hours yesterday experimenting with the concept and I liked what I found, but I was not able to generate a binary which I could directly execute and trade key value pairs over stdin and stdout like I could with the mysql connector. The re2xs perl library enabled me to access a shared library to at least test out the pattern matching. I was able to specify a regex pattern in a perl script, and then match it against the compiled regular expressions, even with a back reference (aka backtrack).</p>
<p>What's so cool about this? To tell you the truth, I think its mostly novelty at the moment. Fact is, modrewrite rule sets can be organized as includes in the configuration file to make them manageable, and I imagine that the Apache team has figured out a way to optimize the pattern matching already. It might be able to fill a gap where mod_dbd and modrewrite miss each other, providing some optimized regexp logic between a sql result set and a rule result.</p>
<p>There is also the conceptual goodie here - the simple overlap between apache and spamassassin. We've seen many a pondering about using spamassassin to filter comment spam, but its never really come to life. There may be a special use case where the patterns and subjects are much larger than urls (like post payloads), where the need for highly optimized regular expression scanning makes sense. In this case, you could write up some spamassassin rules which include some patterns for post payloads, and accept or deny the request based upon the result. I'm not sure if this would be better as a filter or a modrewrite external program (can modrewrite access POST payloads?), and it might be able to work either way.</p>
<h4><strong>Apache Folks are better at C than me</strong></h4>
<p>So again while it was very interesting to work with C, its not efficacious for me to delve too deep. I'm going to focus on the conceptual side, wondering about abstracting modrewrite components into useful groupings. In my environment, there are some best practices emerging, and I'm hoping to refine them and share them with the community so that the Apache and its rocking good modules can be leveraged even more.</p>
<p>Like....</p>
<h4><strong>mod_proxy</strong></h4>
<p>Amazing functionality, somewhat difficult to configure, but modrewrite makes it a cakewalk.</p>
<h4><strong>modrewrite</strong></h4>
<p>Again totally amazing, but the balance between flexibility and clarity can be a tough strike.</p>
<h4><strong>mod_fcgid</strong></h4>
<p>Here's one that doesn't need much, but could be handled better if perhaps it was running on a separate, proxied server. In that case, it would make sense to use something like mod_proxy.</p>
<h4><strong>mod_svn / mod_dav</strong></h4>
<p>Again, might be better to move off the front lines? NOTE: I couldn't get mod_proxy to work with mod_digest, though I think <a href="http://search.cpan.org/~cgilmore/Apache-ProxyRewrite-0.17/ProxyRewrite.pm">this mod_perl module apache::proxyrewrite might be able to handle proxied digest authentication</a>.</p>
<h4><strong>mod_xslt / xslt filter</strong></h4>
<p>I have been eagerly testing out and trying out mod_xslt and xslt filter. I don't use either in production because mod_xslt includes a really lame server signature comment at the end of every rendered page. It can be turned off, but that requires recompilation. the xslt filter is nice and simple (though I'm not sure if it supports the caching of stylesheets) but its not currently included in the debian repositories.</p>
<h4><strong>mod_defensible</strong></h4>
<p>This isn't an Apache maintained module, but it is very nice nonetheless. I've hacked it up a bit, and use it on a few sites. I'd like to see it used in conjunction with a spamassassin-like points system, rather than outright blockage.</p>
<h4><strong>aaa</strong></h4>
<p>Authentication, Authorization, and Access - could use a little more flexibility, especially when it comes to cidr matching. mod_authz_host is incredibly well thought out in terms of access control, but remains black and white. I wish it were possible to use cidr matching with something like setenvif, which could be used to add up points to change how different clients are handled.</p>
<p>Somewhat related - this looks awesome: <a href="https://neon1.net/mod_auth_pubtkt/"><a href="https://neon1.net/mod_auth_pubtkt/">https://neon1.net/mod_auth_pubtkt/</a></a></p>
<h4><strong>mod_qos</strong></h4>
<p>Not an apache maintained module, but would be very useful with managing quality of service with limited resources, and low-contrast acls.</p>
<p>Random: this looks interesting - <a href="http://appsamurai.sourceforge.net/">appsamurai</a>.</p></div></div><div><span>Yearly Indexes: </span><span><a href="/2003/"><span>2003</span></a> </span><span><a href="/2004/"><span>2004</span></a> </span><span><a href="/2006/"><span>2006</span></a> </span><span><a href="/2007/"><span>2007</span></a> </span><span><a href="/2008/"><span>2008</span></a> </span><span><a href="/2009/"><span>2009</span></a> </span><span><a href="/2010/"><span>2010</span></a> </span><span><a href="/2011/"><span>2011</span></a> </span><span><a href="/2012/"><span>2012</span></a> </span><span><a href="/2013/"><span>2013</span></a> </span><span><a href="/2015/"><span>2015</span></a> </span><span><a href="/2019/"><span>2019</span></a> </span><span><a href="/2020/"><span>2020</span></a> </span><span><a href="/2022/"><span>2022</span></a> </span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2008/06/c-is-for-kool-and-some-apache-stuff/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9068a959998310636008.js"],"app":["/app-578f356f1ad3d3b2b65e.js"],"component---src-pages-about-js":["/component---src-pages-about-js-738961a9611f9aa4e8d4.js"],"component---src-pages-games-react-nuzaq-js":["/component---src-pages-games-react-nuzaq-js-50d5da494a82a1aaeb8b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-3aa2421409c5653df938.js"],"component---src-pages-years-js":["/component---src-pages-years-js-d36f319c6c16ef9e8314.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js"],"component---src-templates-year-js":["/component---src-templates-year-js-e8af3ddab603f61c6142.js"]};/*]]>*/</script><script src="/polyfill-9068a959998310636008.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js" async=""></script><script src="/commons-bbb2797d08d51fd1bd26.js" async=""></script><script src="/app-578f356f1ad3d3b2b65e.js" async=""></script><script src="/framework-e27ef662c918f795a5a3.js" async=""></script><script src="/webpack-runtime-910253975eed29c257e8.js" async=""></script></body></html>