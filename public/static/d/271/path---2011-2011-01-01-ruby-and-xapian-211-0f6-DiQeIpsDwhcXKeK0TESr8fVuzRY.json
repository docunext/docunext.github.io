{"data":{"markdownRemark":{"html":"<p>Today I <strong>FINALLY</strong> got around to automating the process of updating my Xapian indexes that contain information from the blogs and wikis I manage.</p>\n<p>I'm writing about it here because I'm using the Ruby xapian-full gem to do most of the work. To automate the process, I copied the apt-xapian-index cron task found in /etc/cron.weekly and modified it like so:</p>\n<pre class=\"sh_sh\">\n#!/bin/sh\nCMD=/usr/local/sbin/svx/xapianindex.sh\nIONICE=/usr/bin/ionice\n# Rebuild the index\nif [ -x $CMD ]\nthen\n  if [ -x $IONICE ]\n  then\n    nice $IONICE -c3 $CMD --quiet\n  else\n    nice $CMD --quiet\n  fi\nfi\n</pre>\n<p>I think this will work just fine.</p>\n<p>And some example code to search the xapian index:</p>\n<pre class=\"sh_ruby\">\n#!/usr/bin/ruby1.9.1\nrequire 'xapian-fu'\ninclude XapianFu\nxpdb = '/var/lib/xapian-indexes/blogsandwikis.db'\ndb = XapianDb.new(:dir => xpdb)\ndb.search(ARGV[0]).each do |match|\n  puts \"* [#{match.values[:title]}](#{match.values[:url]})\"\nend\n</pre>\n<p>It took me awhile to actually give xapian a try, but I'm so glad I did. I plan to use it much more in the future for searching, but also for finding and promoting associated relationships between content.</p>","frontmatter":{"title":"Ruby and Xapian"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2011/2011-01-01-ruby-and-xapian/"}}