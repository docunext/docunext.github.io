{"data":{"markdownRemark":{"html":"<p>I have a lot of appreciation for libTidy - its an awesome tool for avoiding issues when dealing with foreign HTML and trying to transform it with XSL.</p>\n<p>However, I ran into an issue yesterday that I think is worth mentioning that involves the words in the title of this post:</p>\n<ul>\n<li>XSL</li>\n<li>HTML Comments</li>\n<li>CDATA</li>\n<li>Script Tags (elements)</li>\n</ul>\n<p>You may have come across this type of code in the source of an HTML document:</p>\n<pre class=\"sh_html\">\n&lt;script type=\"text/javascript\">\n&lt;!--\nvar something = '&lt;something&gt;else';\n--&gt;\n&lt;script>\n</pre>\n<p>The comment is in there to prevent the (x)HTML processor from processing the javascript, which contains invalid (x)HTML.</p>\n<p>LibTidy does something similar, it wraps the inner contents of script tags with CDATA elements. This was problematic for me because I was then trying to process the output with XSL. XSL escaped the CDATA comment tag as:</p>\n<pre class=\"sh_html\">\n&amp;lt;!--\n</pre>\n<p>which caused javascript processing to fail.</p>\n<p>I was able to work around this first by disabling output escaping in my stylesheet for script tags, but I decided to fix the problem at the root and remove the comment tags.</p>\n<p>I read up on when comment or CDATA tags are required for script tags and decided I don't need them if I'm careful about the inline javascript I use - a good practice in its own right!</p>\n<p>So now the default behavior is that libTidy is escaping script tag contents with CDATA tags, and libXSLT escapes their content, dropping the CDATA tags. Works fine as long as there aren't any entities in there!</p>\n<p>UPDATE: After wrestling with the comment, I found <a href=\"http://www.docunext.com/blog/2010/05/the-strangest-bug-ive-ever-encountered.html\">the strangest bug I've ever encountered</a>.</p>","frontmatter":{"title":"XSL CDATA libTidy HTML Comments and Script Elements","date":"May 24th, 2010"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2010/05/xsl-cdata-libtidy-html-comments-and-script-elements/"}}