{"data":{"markdownRemark":{"html":"<p>This is similar to the defensible module I tried out last year, but it appears to work really well. Its available in debian, which is convenient, but since I run Apache behind a reverse proxy (most likely Varnish), I need to switch around the X-Forwarded-For headers.</p>\n<p>Thankfully, this works fine: <a rel=\"nofollow\"  href=\"http://www.openinfo.co.uk/apache/index.html\">http://www.openinfo.co.uk/apache/index.html</a>. Since the author of mod<em>extract</em>forwarded used Apache 2.0, I've just emailed to share that I have succeeded in compiling it with 2.2:</p>\n<blockquote class=\"svxlb\"><pre>\nJust a heads up that mod_extract_forwarded.c works for me with Apache 2.2 on Debian Squeeze. I'm using it to bridge between Varnish and mod-spamhaus.\n</pre></blockquote>\n<p>I did run into a small issue on debian, the proxy modules must be loaded first, and apxs2 couldn't activate the module for me in httpd.conf (because its blank on debian). I used this name as the module loader: \"proxy<em>xtract</em>forwarded\", and this as its contents:</p>\n<pre class=\"sh_sh\">\nLoadModule extract_forwarded_module  /usr/lib/apache2/modules/mod_extract_forwarded.so\n</pre>\n<p>And for the configuration:</p>\n<pre class=\"sh_xml\">\n&lt;IfModule mod_extract_forwarded.c>\nMEFaccept all\nMEFdebug off\n&lt;/IfModule>\n</pre>\n<p>Note: this is on my development machine. I'll change MEFaccept on any production machines I install this on.</p>\n<p>For more information on mod-spamhaus, here's a link to the author's website: <a href=\"http://www.lucaercoli.it/\" rel=\"nofollow\">Luca Ercoli</a>.</p>\n<p><a href=\"http://varnish.projects.linpro.no/ticket/203\" rel=\"nofollow\">This</a> page about X-Forwarded-For at the Varnish trac was helpful too.</p>","frontmatter":{"title":"Apache2 Spamhaus and X Forwarded Module","date":"March 22nd, 2009"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2009/2009-03-22-apache2-spamhaus-and-x-forwarded-module/"}}