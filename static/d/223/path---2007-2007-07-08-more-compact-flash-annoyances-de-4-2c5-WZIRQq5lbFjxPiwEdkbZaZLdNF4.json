{"data":{"markdownRemark":{"html":"<p>I'm trying to use debian on a compact flash card, but keep running into dma problems. I'm surprised this is such a pain in the neck. This looks helpful though:</p>\n<p><a rel=\"nofollow\" href=\"http://www.debianhelp.org/node/5042\">http://www.debianhelp.org/node/5042</a></p>\n<p>I run into the same problem with pfsense.</p>\n<p>The new /etc/mkinitrd/modules file:</p>\n<pre class=\"sh_sh\">\nmodprobe -k  tulip\nmodprobe -k  sis900\nmodprobe -k  vesafb &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  fbcon 2&gt; /dev/null\nmodprobe -k  unix 2&gt; /dev/null\nmodprobe -k  pdc202xx_new &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  aec62xx &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  alim15x3 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  amd74xx &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  atiixp &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  cmd64x &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  cs5520 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  cs5530 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  cy82c693 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  generic &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  hpt34x &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  hpt366 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  ns87415 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  opti621 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  pdc202xx_old &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  piix &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  rz1000 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  sc1200 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  serverworks &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  siimage &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  sis5513 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  slc90e66 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  triflex &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  trm290 &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  via82cxxx &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  ide-generic\nmodprobe -k  ide-disk\n</pre>\n<p>The original /etc/mkinitrd/modules file:</p>\n<pre class=\"sh_sh\">\nmodprobe -k  loop\nmodprobe -k  ext3\nmodprobe -k  jbd\nmodprobe -k  ide-generic\nmodprobe -k  ide-disk\nmodprobe -k  ide-scsi\nmodprobe -k  ide-cd\nmodprobe -k  ehci-hcd\nmodprobe -k  ohci-hcd\nmodprobe -k  uhci-hcd\nmodprobe -k  sd-mod\nmodprobe -k  usb-storage\nmodprobe -k  8139too\nmodprobe -k  mii\nmodprobe -k  af-packet\nmodprobe -k  unix\nmodprobe -k  ds\nmodprobe -k  yenta-socket\nmodprobe -k  vesafb &gt; /dev/null 2&gt;&amp;1\nmodprobe -k  fbcon 2&gt; /dev/null\nmodprobe -k  unix 2&gt; /dev/null\n</pre>\n<p>Interesting. By following the setup from the original initrd, I was able to avoid the dma issue</p>\n<pre class=\"sh_sh\">\nmount -t cramfs /boot/initrd.img-2.4.27-3-686 /mnt/initrd -o loop\n</pre>\n<p>(<a href=\"http://kernel-handbook.alioth.debian.org/ch-initramfs.html\" rel=\"nofollow\">initrd archive at debian.org</a>)</p>\n<p>The original debian image is from <a href=\"http://shopping.hacom.net/catalog/\" rel=\"nofollow\">Hacom</a>. Their server is really slow so I'll offer the images that I altered here when they are ready .</p>\n<p>Actually, the modules lists above don't need the \"modprobe -k\". Here's what I used to recreate the initrd.img:</p>\n<pre class=\"sh_sh\">\nloop\next3\njbd\nide-generic\nide-disk\nide-scsi\nide-cd\nehci-hcd\nohci-hcd\nuhci-hcd\nsd-mod\nusb-storage\nmii\nunix\nfbcon 2&gt; /dev/null\nunix 2&gt; /dev/null\n</pre>\n<p>In the future, I plan to <a href=\"http://www.my-tech-deals.com/blog/2007/07/compact-flash-as-a-hard-drive.html\">buy this compact flash card for use as a hard drive</a>.</p>","frontmatter":{"title":"More Compact Flash Annoyances"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2007/2007-07-08-more-compact-flash-annoyances/"}}