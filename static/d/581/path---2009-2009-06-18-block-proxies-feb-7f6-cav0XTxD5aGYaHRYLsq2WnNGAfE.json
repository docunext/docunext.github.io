{"data":{"markdownRemark":{"html":"<p>I found this mod_rewrite configuration at <a href=\"http://perishablepress.com/press/2008/04/20/how-to-block-proxy-servers-via-htaccess/\">Perishable Press</a>:</p>\n<pre>RewriteEngine on\nRewriteCond %{REQUEST_METHOD} POST\nRewriteCond %{HTTP:VIA}                 !^$ [OR]\nRewriteCond %{HTTP:FORWARDED}           !^$ [OR]\nRewriteCond %{HTTP:USERAGENT_VIA}       !^$ [OR]\nRewriteCond %{HTTP:X_FORWARDED_FOR}     !^$ [OR]\nRewriteCond %{HTTP:PROXY_CONNECTION}    !^$ [OR]\nRewriteCond %{HTTP:XPROXY_CONNECTION}   !^$ [OR]\nRewriteCond %{HTTP:HTTP_PC_REMOTE_ADDR} !^$ [OR]\nRewriteCond %{HTTP:HTTP_CLIENT_IP}      !^$\nRewriteRule ^(.*)$ - [F]\n</pre>\n<p>Then I added this:</p>\n<pre>RewriteCond %{REQUEST_METHOD} POST\n</pre>\n<p>at the beginning. I might remove that as the post another post about blocking proxies said that some of them strip out my ads and insert their own. That's not cool!</p>\n<p>But one problem with all this: since I use Varnish, the legitimate requests have some of those headers already. I'm going to try and come up with a regular expression to allow forwarding from my Varnish proxies, but block other ones. This will also help with <a href=\"http://www.docunext.com/wiki/Mod_extract_forwarded\">mod<em>extract</em>forwarded</a>!</p>","frontmatter":{"title":"Block Proxies"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2009/2009-06-18-block-proxies/"}}