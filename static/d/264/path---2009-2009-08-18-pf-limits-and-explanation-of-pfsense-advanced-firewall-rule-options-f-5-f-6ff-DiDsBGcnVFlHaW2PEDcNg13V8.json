{"data":{"markdownRemark":{"html":"<p>Last night I finally took the time to learn what the \"advanced\" options are in the pfsense firewall rule form. You know the ones, these guys:</p>\n<span style=\"display: inline;\">\n<p>I finally got fed up after one too many misbehaving bot caused one of my Apache servers to spawn way too many instances.</p>\n<p>Basically, all I learned is thanks to: <a href=\"https://calomel.org/pf_config.html\">https://calomel.org/pf_config.html</a> and a little from <a href=\"http://www.openbsd.org/faq/pf/config.html\">http://www.openbsd.org/faq/pf/config.html</a>.</p>\n<p>To make the connection between the calomel explanations and the pfsense descriptions, I ran pfctl -sr and gathered this information:</p>\n<pre>max-src-states 120, max-src-conn-rate 30/100, max-src-nodes 10000 overload &lt;virusprot&gt; flush global, tcp.established 5, src.track 100</pre>\n<p>The following is a rough idea of the settings I'm using, with additional notes of mine in bold to remind me of why I set the numbers the way I did. Also, based on the recommendation of calomel, I'm using synproxy state. I should also mention that this is just an HTTP rule!</p>\n<p>Advanced Options</p>\n<p>Simultaneous client connection limit\n10000 <b>number of ip addresses which can connect</b></p>\n<p>Maximum state entries per host\n120\n40 <b>established states at a time (3 per established roughly)</b></p>\n<p>Maximum new connections / per second\n30 / 100 seconds\n<b>this is per ip!?!</b></p>\n<p>State Timeout in seconds\n5\n<b>(Varnish default timeout)</b></p>\n<p>Â¥</p>","frontmatter":{"title":"pf Limits and Explanation of pfSense Advanced Firewall Rule Options","date":"August 18th, 2009"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2009/2009-08-18-pf-limits-and-explanation-of-pfsense-advanced-firewall-rule-options/"}}