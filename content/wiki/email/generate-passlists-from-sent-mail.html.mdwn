This is based off the script on the Spamassassin website:

    #!/bin/sh

    SADIR=/home/username/.spamassassin
    SENTMAIL="/home/username/.maildir/.Sent Messages/cur/"

    touch $SADIR/sent_whitelist
    rm -f $SADIR/sent_whitelist
    #ls "$SENTMAIL"

    for x in `grep -r "^To:" "$SENTMAIL" |
            grep -o "[[:alnum:]\.\+\-\_]*@[[:alnum:]\.\-]*" |
            tr "A-Z" "a-z" |
            sort -u` ;

            do echo "whitelist_from $x" >> $SADIR/sent_whitelist
    done

    cat $SADIR/user_prefs.base $SADIR/sent_whitelist > $SADIR/user_prefs

