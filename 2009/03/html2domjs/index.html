<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.742409eb857ab2ccca34.css" data-identity="gatsby-global-css">li{margin-right:1rem}h1,li{display:inline-block}h1{font-style:normal;margin-top:0}header{margin-bottom:1.5rem}header ul{float:right;list-style:none}#wrapper{margin:3em auto;max-width:700px;padding:10px}.blogPostDate{color:#333;font-size:8pt;margin-bottom:9px;padding-top:4px}</style><meta name="generator" content="Gatsby 4.4.0"/><title data-react-helmet="true">html2dom.js xhtml2dom.xsl</title><link data-react-helmet="true" rel="canonical" href="https://www.docunext.com/2009/03/html2domjs/"/><link as="script" rel="preload" href="/webpack-runtime-910253975eed29c257e8.js"/><link as="script" rel="preload" href="/framework-e27ef662c918f795a5a3.js"/><link as="script" rel="preload" href="/app-578f356f1ad3d3b2b65e.js"/><link as="script" rel="preload" href="/commons-bbb2797d08d51fd1bd26.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js"/><link as="fetch" rel="preload" href="/page-data/2009/03/html2domjs/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2191495970.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4224293195.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="wrapper"><header><ul><li><a href="/about/">About</a></li></ul><a href="/"><h1>Docunext</h1></a></header><hr/><div><h2>html2dom.js xhtml2dom.xsl</h2><div class="blogPostDate">March 24th, 2009</div><div><p>I've been evaluating different strategies for caching parts of an XHTML page, like a header, footer, or sidebar. I've come to the conclusion that the best way to do this is to store the xhtml as a dom object in javascript. It could also be stored as plain XHTML, but then there are issues with multi-line strings in javascript.</p>
<p>It would be possible to use <a href="http://www.docunext.com/4X">E4X (EMCAscript for XML)</a>, but that is not widely supported by browsers yet.</p>
<p>So anyway back to Javascript DOM code. Its not as simple to write as HTML, and there are many convenience packages to help this, but I'm under the impression that may reduce its efficiency.</p>
<p>I did some searching on ways to generate Javascript DOM code from XHTML found <a href="http://html2dom.com/">html2dom</a>. It does exactly what I was looking for, but the code doesn't have an explicit license. The author states on another page that the code is in the public domain, but I would feel more comfortable if that were included in the code itself.</p>
<p>Then there is the issue that I don't have a server-side javascript interpreter setup. These are somewhat rare, though they are getting much more prevalent, and I expect that to continue. Since I'm a big fan of <a href="/wiki/XSLT">XSLT</a>, I've decided to try writing a stylesheet which would convert xhtml to dom code. Its very rough at this point, but I'm checking it into the PBooks repository and will post a link once its published. The only real hurdle I ran into was dealing with multi-line text nodes. As usual, they cause some problems with javascript, but I just used the translate function to remove all newlines. I also ran into an issue that the style attribute is read-only. Not a big deal, I need to refrain from using in-line <a href="/wiki/CSS">CSS</a> anyway. The stylesheet is basically an identity transform that converts <a href="/wiki/XML">XML</a> to Javascript <a href="/wiki/DOM">DOM</a> instructions. Another cool thing about this is that the resulting dom code can be gzipped and cached as long as it doesn't change too much. That is a good thing!</p>
<p>Here is a link to the first revision of <a href="http://www.pbooks.org/trac/browser/trunk/apps/pbooks/templates/js/dom_generator.js.xsl">xhtml2dom.xsl</a>.</p>
<p>I like how this is working. For some reason, I'm now thinking about javascript parsers. Does such a thing exist? I think it would be possible to create one using <a href="/wiki/Ragel">Ragel</a>. Here is one implemented in Ruby: <a href="http://idontsmoke.co.uk/2005/rbnarcissus/">rbNarcissus</a> (and a backup of the code <a href="http://www.docunext.com/.rb">here</a>).</p>
<p>UPDATE: Instead of the translate function for newlines, I'm using the <a href="http://www.xmlplease.com/whitespace">normalize-whitespace function suggested here at xmlplease.com/whitespace</a>.</p></div></div><div><span>Yearly Indexes: </span><span><a href="/2003/"><span>2003</span></a> </span><span><a href="/2004/"><span>2004</span></a> </span><span><a href="/2006/"><span>2006</span></a> </span><span><a href="/2007/"><span>2007</span></a> </span><span><a href="/2008/"><span>2008</span></a> </span><span><a href="/2009/"><span>2009</span></a> </span><span><a href="/2010/"><span>2010</span></a> </span><span><a href="/2011/"><span>2011</span></a> </span><span><a href="/2012/"><span>2012</span></a> </span><span><a href="/2013/"><span>2013</span></a> </span><span><a href="/2015/"><span>2015</span></a> </span><span><a href="/2019/"><span>2019</span></a> </span><span><a href="/2020/"><span>2020</span></a> </span><span><a href="/2022/"><span>2022</span></a> </span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2009/03/html2domjs/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9068a959998310636008.js"],"app":["/app-578f356f1ad3d3b2b65e.js"],"component---src-pages-about-js":["/component---src-pages-about-js-738961a9611f9aa4e8d4.js"],"component---src-pages-games-react-nuzaq-js":["/component---src-pages-games-react-nuzaq-js-50d5da494a82a1aaeb8b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-3aa2421409c5653df938.js"],"component---src-pages-years-js":["/component---src-pages-years-js-d36f319c6c16ef9e8314.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js"],"component---src-templates-year-js":["/component---src-templates-year-js-e8af3ddab603f61c6142.js"]};/*]]>*/</script><script src="/polyfill-9068a959998310636008.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-cc8ebf9459c2ce2cf980.js" async=""></script><script src="/commons-bbb2797d08d51fd1bd26.js" async=""></script><script src="/app-578f356f1ad3d3b2b65e.js" async=""></script><script src="/framework-e27ef662c918f795a5a3.js" async=""></script><script src="/webpack-runtime-910253975eed29c257e8.js" async=""></script></body></html>